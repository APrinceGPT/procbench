# ProcBench Environment Configuration
# Copy this file to .env and fill in the actual values
# NEVER commit .env file to version control

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================

# Port to run the server on
PORT=8080

# Host to bind to (0.0.0.0 for all interfaces)
HOST=0.0.0.0

# Environment: development, staging, production
ENVIRONMENT=development

# =============================================================================
# FILE HANDLING
# =============================================================================

# Maximum file upload size in MB (default: 500)
MAX_FILE_SIZE_MB=500

# Maximum concurrent analyses (to prevent resource exhaustion)
MAX_CONCURRENT_ANALYSES=10

# Temporary file storage path
TEMP_PATH=/tmp/procbench

# =============================================================================
# AI CONFIGURATION
# =============================================================================

# AI Provider: openai, azure, custom
AI_PROVIDER=openai

# API Base URL (for OpenAI-compatible APIs)
AI_BASE_URL=https://api.openai.com/v1

# API Key (required)
AI_API_KEY=sk-your-api-key-here

# Model to use
AI_MODEL=gpt-4

# =============================================================================
# AI RATE LIMITING (Configurable)
# =============================================================================

# Maximum requests per minute to AI API
AI_RATE_LIMIT_REQUESTS=10

# Maximum tokens per minute (if applicable)
AI_RATE_LIMIT_TOKENS=10000

# Number of processes to batch per AI request
AI_BATCH_SIZE=15

# Request timeout in seconds
AI_TIMEOUT_SECONDS=30

# Maximum retry attempts on failure
AI_MAX_RETRIES=3

# =============================================================================
# DETECTION ENGINE
# =============================================================================

# Path to custom rules directory
CUSTOM_RULES_PATH=./rules/custom

# Enable/disable specific detection modules
DETECTION_LOLBAS_ENABLED=true
DETECTION_SUSPICIOUS_PATHS_ENABLED=true
DETECTION_PARENT_CHILD_ENABLED=true
DETECTION_PERSISTENCE_ENABLED=true
DETECTION_CREDENTIAL_ACCESS_ENABLED=true

# =============================================================================
# LOGGING
# =============================================================================

# Log level: debug, info, warn, error
LOG_LEVEL=info

# Log format: json, text
LOG_FORMAT=json

# Log output: stdout, file
LOG_OUTPUT=stdout

# Log file path (if LOG_OUTPUT=file)
LOG_FILE_PATH=./logs/procbench.log

# =============================================================================
# SECURITY
# =============================================================================

# CORS allowed origins (comma-separated)
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173

# Request body size limit
MAX_REQUEST_BODY_SIZE=550MB

# =============================================================================
# PDF EXPORT
# =============================================================================

# Company name for report header (optional)
PDF_COMPANY_NAME=

# Custom logo path (optional)
PDF_LOGO_PATH=

# =============================================================================
# FUTURE: SPLUNK INTEGRATION (v2.0)
# =============================================================================

# SPLUNK_ENABLED=false
# SPLUNK_HEC_URL=https://splunk.example.com:8088
# SPLUNK_HEC_TOKEN=
# SPLUNK_INDEX=procbench
# SPLUNK_SOURCETYPE=procbench:analysis

# =============================================================================
# FUTURE: THREAT INTELLIGENCE (v2.0)
# =============================================================================

# VIRUSTOTAL_API_KEY=
# MISP_URL=
# MISP_API_KEY=
# OTX_API_KEY=
